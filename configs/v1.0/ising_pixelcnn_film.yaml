# v1.0: FiLM-based PixelCNN with Temperature Embedding
# Key improvement: No Tc focus needed - model learns temperature sensitivity automatically
#
# Changes from v0.9:
# - New model: DiscretePixelCNNFiLM (temperature embedding + FiLM conditioning)
# - Removed tc_focus_ratio (no longer needed)
# - Simpler curriculum: just 2 phases (warm-up + full range)
# - Temperature embedding replaces raw T concatenation

project: Ising_VaTD_v1.0
device: cuda:0
net: model.DiscretePixelCNNFiLM
optimizer: torch.optim.AdamW
scheduler: hyperbolic_lr.ExpHyperbolicLR
epochs: 500
batch_size: 512  # Not used for DiscretePixelCNN, but required by RunConfig
seeds: [42]

net_config:
  # Lattice configuration
  size: 16      # 16x16 Ising lattice
  fix_first: 1  # Fix first spin to break symmetry (1 = spin up)

  # Temperature sampling configuration
  batch_size: 256  # Samples per temperature
  num_beta: 8      # Number of temperature samples per batch
  beta_min: 0.2    # 1/T_max (T_max = 5)
  beta_max: 1.0    # 1/T_min (T_min = 1)

  # Simplified 2-Phase Curriculum Learning
  # Phase 1: High temperature only (easier to learn)
  # Phase 2: Full temperature range (model already has good representations)
  # No Phase 3 Tc focus - FiLM embedding handles temperature sensitivity
  curriculum_enabled: true
  phase1_epochs: 100
  phase1_beta_max: 0.35   # T_min = 2.86 (above Tc)
  phase2_epochs: 200      # Duration of expansion phase

  # Tc focus disabled (set to 0) - not needed with FiLM
  tc_focus_ratio: 0.0
  tc_beta_min: 0.38
  tc_beta_max: 0.52

  # Temperature Embedding settings
  # These control how temperature is converted to high-dim representation
  temp_embed_dim: 64      # Dimension of temperature embedding
  temp_hidden_dim: 128    # MLP hidden dimension
  temp_num_freqs: 32      # Number of sinusoidal frequencies

  # Model architecture (same as v0.9)
  kernel_size: 3          # First masked conv kernel size
  hidden_channels: 128    # Wider hidden channels
  hidden_conv_layers: 6   # Number of residual blocks
  hidden_kernel_size: 3   # Kernel size in residual blocks
  hidden_width: 256       # FC layer width
  hidden_fc_layers: 2     # Number of FC layers

optimizer_config:
  lr: 0.005
  weight_decay: 0.00001

scheduler_config:
  upper_bound: 600
  max_iter: 500
  infimum_lr: 0.00001

early_stopping_config:
  enabled: false
  patience: 50
  mode: min
  min_delta: 0.0001
